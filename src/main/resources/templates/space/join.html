<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>스페이스 참여</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #fff;
        }
        h2 { margin-bottom: 30px; font-weight: normal; color: #333; }
        .input-group { width: 300px; margin-bottom: 20px; text-align: left; }
        label { display: block; margin-bottom: 8px; color: #666; font-size: 14px; }
        input {
            width: 100%; padding: 12px;
            background-color: #f2f2f2; border: 1px solid #ddd;
            border-radius: 0; box-sizing: border-box; font-size: 14px;
        }
        .btn-submit {
            width: 300px; padding: 12px;
            background-color: #e0e0e0; border: 1px solid #ccc;
            color: #333; font-size: 16px; cursor: pointer;
        }
        .btn-submit:hover { background-color: #d0d0d0; }
    </style>
</head>
<body>

<h2>스페이스 참여</h2>

<div class="input-group">
    <label>스페이스 코드</label>
    <input type="text" id="spaceCode" placeholder="코드를 입력하세요">
</div>

<button class="btn-submit" onclick="joinSpace()">참여하기</button>

<script>
    function joinSpace() {
        let spaceCode = $("#spaceCode").val().trim();
        if(!spaceCode) { alert("스페이스 코드를 입력해주세요."); return; }

        let accessToken = localStorage.getItem("accessToken");

        $.ajax({
            url: '/api/userSpace/join',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ "spaceCode": spaceCode }),
            beforeSend: function(xhr){
                if(accessToken) xhr.setRequestHeader("Authorization", accessToken);
            },
            success: function() {
                alert("성공적으로 참여되었습니다!");
                location.href = "/space/list";
            },
            error: function(xhr) {
                alert("참여 실패: " + (xhr.responseJSON?.message || "코드를 확인해주세요."));
            }
        });
    }
</script>
</body>
</html>